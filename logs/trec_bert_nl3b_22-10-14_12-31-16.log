> creating model bert
> cuda memory allocated: 439088640
> training arguments:
>>> data_dir: data
>>> dataset: trec
>>> model_name: bert
>>> method: nl3b
>>> train_batch_size: 16
>>> test_batch_size: 64
>>> num_epoch: 30
>>> lr: 1e-05
>>> decay: 0.01
>>> alpha: 0.5
>>> temp: 0.1
>>> backend: False
>>> timestamp: 1665721877321
>>> device: cuda
>>> num_classes: 6
>>> log_name: trec_bert_nl3b_22-10-14_12-31-16.log
1/30 - 3.33%
[train] loss: 0.0896, acc: 17.63
[test] loss: 0.0622, acc: 21.80
2/30 - 6.67%
[train] loss: 0.0132, acc: 17.55
[test] loss: 0.0408, acc: 17.60
3/30 - 10.00%
[train] loss: 0.0111, acc: 16.32
[test] loss: 0.0332, acc: 17.00
4/30 - 13.33%
[train] loss: 0.0093, acc: 16.73
[test] loss: 0.0332, acc: 16.00
5/30 - 16.67%
[train] loss: 0.0087, acc: 17.61
[test] loss: 0.0343, acc: 16.40
6/30 - 20.00%
[train] loss: 0.0084, acc: 17.99
[test] loss: 0.0269, acc: 19.40
7/30 - 23.33%
[train] loss: 0.0078, acc: 17.57
[test] loss: 0.0257, acc: 18.80
8/30 - 26.67%
[train] loss: 0.0077, acc: 17.57
[test] loss: 0.0257, acc: 17.40
9/30 - 30.00%
[train] loss: 0.0078, acc: 17.08
[test] loss: 0.0226, acc: 20.40
10/30 - 33.33%
[train] loss: 0.0072, acc: 16.76
[test] loss: 0.0215, acc: 23.00
11/30 - 36.67%
[train] loss: 0.0066, acc: 17.15
[test] loss: 0.0204, acc: 24.60
12/30 - 40.00%
[train] loss: 0.0069, acc: 17.24
[test] loss: 0.0216, acc: 21.60
13/30 - 43.33%
[train] loss: 0.0063, acc: 16.03
[test] loss: 0.0219, acc: 22.00
14/30 - 46.67%
[train] loss: 0.0064, acc: 18.10
[test] loss: 0.0176, acc: 22.00
15/30 - 50.00%
[train] loss: 0.0062, acc: 16.64
[test] loss: 0.0172, acc: 21.00
16/30 - 53.33%
[train] loss: 0.0065, acc: 16.25
[test] loss: 0.0173, acc: 18.60
17/30 - 56.67%
[train] loss: 0.0061, acc: 16.71
[test] loss: 0.0147, acc: 25.00
18/30 - 60.00%
[train] loss: 0.0059, acc: 17.41
[test] loss: 0.0161, acc: 28.80
19/30 - 63.33%
[train] loss: 0.0060, acc: 16.42
[test] loss: 0.0181, acc: 28.40
20/30 - 66.67%
[train] loss: 0.0058, acc: 16.87
[test] loss: 0.0178, acc: 27.20
21/30 - 70.00%
[train] loss: 0.0053, acc: 16.78
[test] loss: 0.0190, acc: 25.00
22/30 - 73.33%
[train] loss: 0.0053, acc: 16.95
[test] loss: 0.0188, acc: 23.80
23/30 - 76.67%
[train] loss: 0.0053, acc: 16.71
[test] loss: 0.0161, acc: 26.00
24/30 - 80.00%
[train] loss: 0.0058, acc: 16.76
[test] loss: 0.0143, acc: 25.00
25/30 - 83.33%
[train] loss: 0.0050, acc: 15.68
[test] loss: 0.0146, acc: 24.00
26/30 - 86.67%
[train] loss: 0.0047, acc: 17.09
[test] loss: 0.0150, acc: 20.20
27/30 - 90.00%
[train] loss: 0.0048, acc: 16.56
[test] loss: 0.0152, acc: 25.00
28/30 - 93.33%
[train] loss: 0.0052, acc: 16.75
[test] loss: 0.0136, acc: 17.80
29/30 - 96.67%
[train] loss: 0.0048, acc: 16.71
[test] loss: 0.0140, acc: 15.40
30/30 - 100.00%
[train] loss: 0.0048, acc: 16.65
[test] loss: 0.0173, acc: 16.40
best loss: 0.0161, best acc: 28.80
log saved: trec_bert_nl3b_22-10-14_12-31-16.log
