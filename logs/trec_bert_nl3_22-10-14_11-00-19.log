> creating model bert
> cuda memory allocated: 439088640
> training arguments:
>>> data_dir: data
>>> dataset: trec
>>> model_name: bert
>>> method: nl3
>>> train_batch_size: 16
>>> test_batch_size: 64
>>> num_epoch: 30
>>> lr: 1e-05
>>> decay: 0.01
>>> alpha: 0.5
>>> temp: 0.1
>>> backend: False
>>> timestamp: 1665716419435
>>> device: cuda
>>> num_classes: 6
>>> log_name: trec_bert_nl3_22-10-14_11-00-19.log
1/30 - 3.33%
[train] loss: 1.8767, acc: 23.53
[test] loss: 1.2258, acc: 69.60
2/30 - 6.67%
[train] loss: 0.7227, acc: 59.92
[test] loss: 0.6529, acc: 88.80
3/30 - 10.00%
[train] loss: 0.3371, acc: 83.82
[test] loss: 0.4029, acc: 95.20
4/30 - 13.33%
[train] loss: 0.2278, acc: 90.15
[test] loss: 0.4392, acc: 95.40
5/30 - 16.67%
[train] loss: 0.1586, acc: 93.05
[test] loss: 0.3217, acc: 96.20
6/30 - 20.00%
[train] loss: 0.1224, acc: 95.16
[test] loss: 0.3098, acc: 97.20
7/30 - 23.33%
[train] loss: 0.0946, acc: 96.31
[test] loss: 0.2756, acc: 97.60
8/30 - 26.67%
[train] loss: 0.0750, acc: 97.29
[test] loss: 0.3113, acc: 97.40
9/30 - 30.00%
[train] loss: 0.0764, acc: 97.12
[test] loss: 0.3462, acc: 96.40
10/30 - 33.33%
[train] loss: 0.0493, acc: 98.40
[test] loss: 0.3566, acc: 96.60
11/30 - 36.67%
[train] loss: 0.0485, acc: 98.48
[test] loss: 0.3244, acc: 96.00
12/30 - 40.00%
[train] loss: 0.0382, acc: 98.68
[test] loss: 0.2431, acc: 97.20
13/30 - 43.33%
[train] loss: 0.0331, acc: 99.03
[test] loss: 0.3289, acc: 96.60
14/30 - 46.67%
[train] loss: 0.0373, acc: 98.72
[test] loss: 0.2949, acc: 97.00
15/30 - 50.00%
[train] loss: 0.0311, acc: 99.16
[test] loss: 0.2907, acc: 96.60
16/30 - 53.33%
[train] loss: 0.0326, acc: 99.21
[test] loss: 0.2544, acc: 97.20
17/30 - 56.67%
[train] loss: 0.0253, acc: 99.23
[test] loss: 0.2271, acc: 97.40
18/30 - 60.00%
[train] loss: 0.0277, acc: 99.36
[test] loss: 0.3030, acc: 96.80
19/30 - 63.33%
[train] loss: 0.0204, acc: 99.61
[test] loss: 0.2734, acc: 97.20
20/30 - 66.67%
[train] loss: 0.0240, acc: 99.49
[test] loss: 0.2361, acc: 97.00
21/30 - 70.00%
[train] loss: 0.0249, acc: 99.45
[test] loss: 0.2572, acc: 96.80
22/30 - 73.33%
[train] loss: 0.0222, acc: 99.52
[test] loss: 0.3984, acc: 96.00
23/30 - 76.67%
[train] loss: 0.0187, acc: 99.56
[test] loss: 0.2775, acc: 96.60
24/30 - 80.00%
[train] loss: 0.0142, acc: 99.72
[test] loss: 0.2828, acc: 97.20
25/30 - 83.33%
[train] loss: 0.0158, acc: 99.76
[test] loss: 0.2952, acc: 96.80
26/30 - 86.67%
[train] loss: 0.0250, acc: 99.28
[test] loss: 0.2646, acc: 97.40
27/30 - 90.00%
[train] loss: 0.0152, acc: 99.72
[test] loss: 0.2837, acc: 97.00
28/30 - 93.33%
[train] loss: 0.0154, acc: 99.60
[test] loss: 0.3015, acc: 97.00
29/30 - 96.67%
[train] loss: 0.0179, acc: 99.65
[test] loss: 0.3035, acc: 97.40
30/30 - 100.00%
[train] loss: 0.0115, acc: 99.85
[test] loss: 0.3429, acc: 97.20
best loss: 0.2756, best acc: 97.60
log saved: trec_bert_nl3_22-10-14_11-00-19.log
